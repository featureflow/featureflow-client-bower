!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Featureflow=t():e.Featureflow=t()}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=3)}([function(e,t,n){"use strict";function r(e,t){var n=new XMLHttpRequest;return n.addEventListener("load",function(){200===n.status&&"application/json;charset=UTF-8"===n.getResponseHeader("Content-type")?t(null,JSON.parse(n.responseText)):t(n.statusText)}),n.addEventListener("error",function(){t(n.statusText)}),n.open("GET",e),n.send(),n}function o(e){return btoa(JSON.stringify(e))}t.a={getFeatures:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],u=arguments[4],a=i.length>0?"?keys="+i.join(","):"";r(e+"/api/js/v1/evaluate/"+t+"/context/"+encodeURI(o(n))+a,u)}}},function(e,t){function n(){}n.prototype={on:function(e,t,n){var r=this.e||(this.e={});return(r[e]||(r[e]=[])).push({fn:t,ctx:n}),this},once:function(e,t,n){function r(){o.off(e,r),t.apply(n,arguments)}var o=this;return r._=t,this.on(e,r,n)},emit:function(e){var t=[].slice.call(arguments,1),n=((this.e||(this.e={}))[e]||[]).slice(),r=0,o=n.length;for(r;r<o;r++)n[r].fn.apply(n[r].ctx,t);return this},off:function(e,t){var n=this.e||(this.e={}),r=n[e],o=[];if(r&&t)for(var i=0,u=r.length;i<u;i++)r[i].fn!==t&&r[i].fn._!==t&&o.push(r[i]);return o.length?n[e]=o:delete n[e],this}},e.exports=n},function(e,t){e.exports=function(e){if(!e.webpackPolyfill){var t=Object.create(e);t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),Object.defineProperty(t,"exports",{enumerable:!0}),t.webpackPolyfill=1}return t}},function(e,t,n){"use strict";(function(e){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e){function t(t){b=s({},c,t);try{p=JSON.parse(localStorage.getItem("ff:"+b.key+":"+e)||"{}")}catch(e){p={}}return i.a.getFeatures(y.baseUrl,e,b,[],function(t,n){t?g.emit(h.ERROR,t):(p=n||{},localStorage.setItem("ff:"+b.key+":"+e,JSON.stringify(p)),g.emit(h.LOADED,n))}),b}function n(){return p}function o(){return b}var u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},p={},y=void 0,b=void 0,g=new a.a;if(!e)throw v;if(y=s({},d,l),t(u),y.streaming){var O=new window.EventSource(y.rtmUrl+"/api/js/v1/stream/"+e);O.onmessage=function(t){var n=[];try{n=JSON.parse(t.data)}catch(e){}i.a.getFeatures(y.baseUrl,e,b,n,function(e,t){p=s({},p,t),g.emit(h.UPDATED_FEATURE,t)})}}var w=function(){function e(t){r(this,e),this.key=t}return f(e,[{key:"value",value:function(){return p[this.key]||y.defaultFeatures[this.key]||"off"}},{key:"is",value:function(e){return e.toLowerCase()===this.value().toLowerCase()}},{key:"isOn",value:function(){return this.is("on")}},{key:"isOff",value:function(){return this.is("off")}}]),e}();return{updateContext:t,getFeatures:n,getContext:o,evaluate:function(e){return new w(e)},on:g.on.bind(g),off:g.off.bind(g)}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),u=n(1),a=n.n(u);n.d(t,"events",function(){return h}),t.init=o;var f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},c={key:"anonymous"},l="https://app.featureflow.io",p="https://rtm.featureflow.io",d={baseUrl:l,rtmUrl:p,streaming:!0,defaultFeatures:{}},v=new Error("init() has not been called with a valid apiKey"),h={LOADED:"LOADED",ERROR:"ERROR",UPDATED_FEATURE:"UPDATED_FEATURE"};t.default={init:o,events:h},void 0!==window.VERSION&&(e.exports.version=window.VERSION)}).call(t,n(2)(e))}])});