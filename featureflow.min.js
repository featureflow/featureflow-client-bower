/*!
 * Featureflow Client v0.2.1
 * Web: https://www.featureflow.io/
 * Date: 2017-03-07T05:09:38.692Z
 * Licence: Apache-2.0
 */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Featureflow=t():e.Featureflow=t()}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var a=n[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,t),a.l=!0,a.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=4)}([function(e,t,n){"use strict";function r(e,t){var n=new XMLHttpRequest;return n.addEventListener("load",function(){200===n.status&&"application/json;charset=UTF-8"===n.getResponseHeader("Content-type")?t(null,JSON.parse(n.responseText)):t(n.statusText)}),n.addEventListener("error",function(){t(n.statusText)}),n.open("GET",e),n.setRequestHeader("X-Featureflow-Client","javascript-"+i.a.version),n.send(),n}function a(e){return btoa(JSON.stringify(e))}var o=n(3),i=n.n(o);t.a={getFeatures:function(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments[4],s=o.length>0?"?keys="+o.join(","):"";r(e+"/api/js/v1/evaluate/"+t+"/context/"+encodeURI(a(n))+s,i)}}},function(e,t){function n(){}n.prototype={on:function(e,t,n){var r=this.e||(this.e={});return(r[e]||(r[e]=[])).push({fn:t,ctx:n}),this},once:function(e,t,n){function r(){a.off(e,r),t.apply(n,arguments)}var a=this;return r._=t,this.on(e,r,n)},emit:function(e){var t=[].slice.call(arguments,1),n=((this.e||(this.e={}))[e]||[]).slice(),r=0,a=n.length;for(r;r<a;r++)n[r].fn.apply(n[r].ctx,t);return this},off:function(e,t){var n=this.e||(this.e={}),r=n[e],a=[];if(r&&t)for(var o=0,i=r.length;o<i;o++)r[o].fn!==t&&r[o].fn._!==t&&a.push(r[o]);return a.length?n[e]=a:delete n[e],this}},e.exports=n},function(e,t){e.exports=function(e){if(!e.webpackPolyfill){var t=Object.create(e);t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),Object.defineProperty(t,"exports",{enumerable:!0}),t.webpackPolyfill=1}return t}},function(e,t){e.exports={name:"featureflow-client",version:"0.2.1",description:"Featureflow Javascipt Client",author:"Featureflow <featureflow@featureflow.io>",license:"Apache-2.0",keywords:["featureflow","feature","analytics","client"],files:["dist"],repository:{type:"git",url:"git+https://github.com/featureflow/featureflow-javascript-sdk.git"},main:"dist/featureflow",scripts:{"build-lib":"webpack src/index.js dist/featureflow.js","build-min":"webpack -p src/index.js dist/featureflow.min.js",build:"node ./scripts/build.js",watch:"webpack --watch src/index.js dist/featureflow.js",test:"karma start --single-run","test:watch":"karma start --auto-watch --reporters=dots",prepublish:"node ./scripts/prepublish.js",flow:"flow",example:"webpack-dev-server --config ./example/webpack.config.js --content-base example/ --inline --port 8182"},devDependencies:{babel:"^6.23.0","babel-core":"^6.23.1","babel-loader":"^6.3.0","babel-plugin-transform-flow-strip-types":"^6.22.0","babel-plugin-transform-object-rest-spread":"^6.23.0","babel-preset-es2015":"^6.22.0",chai:"3.5.0","css-loader":"^0.26.1","file-loader":"^0.10.0","flow-bin":"^0.39.0","gzip-size":"3.0.0","html-webpack-plugin":"^2.28.0","in-publish":"2.0.0",karma:"0.13.22","karma-chai":"0.1.0","karma-chrome-launcher":"1.0.1","karma-mocha":"1.0.1","karma-mocha-reporter":"2.0.4","karma-phantomjs-launcher":"0.2.1","karma-phantomjs-shim":"1.1.2","karma-sinon":"1.0.5","karma-sourcemap-loader":"0.3.7","karma-webpack":"2.0.2",mocha:"2.5.3",phantomjs:"1.9.18","pretty-bytes":"3.0.1","readline-sync":"1.4.4","semver-compare":"^1.0.0",sinon:"1.17.4","style-loader":"^0.13.1",webpack:"2.2.1","webpack-dev-server":"^2.3.0"},dependencies:{Base64:"1.0.0","escape-string-regexp":"1.0.5",sizzle:"2.3.0","tiny-emitter":"^1.1.0"}}},function(e,t,n){"use strict";(function(e){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e){function t(t){v=c({},f,t);try{p=JSON.parse(localStorage.getItem("ff:"+v.key+":"+e)||"{}")}catch(e){p={}}return o.a.getFeatures(m.baseUrl,e,v,[],function(t,n){t?w.emit(b.ERROR,t):(p=n||{},localStorage.setItem("ff:"+v.key+":"+e,JSON.stringify(p)),w.emit(b.LOADED,n))}),v}function n(){return p}function a(){return v}var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},p={},m=void 0,v=void 0,w=new s.a;if(!e)throw h;if(m=c({},d,l),t(i),m.streaming){var y=new window.EventSource(m.rtmUrl+"/api/js/v1/stream/"+e);y.onmessage=function(t){var n=[];try{n=JSON.parse(t.data)}catch(e){}o.a.getFeatures(m.baseUrl,e,v,n,function(e,t){e?w.emit(b.ERROR,e):(p=c({},p,t),w.emit(b.UPDATED_FEATURE,t))})}}var g=function(){function e(t){r(this,e),this.key=t}return u(e,[{key:"value",value:function(){return p[this.key]||m.defaultFeatures[this.key]||"off"}},{key:"is",value:function(e){return e.toLowerCase()===this.value().toLowerCase()}},{key:"isOn",value:function(){return this.is("on")}},{key:"isOff",value:function(){return this.is("off")}}]),e}();return{updateContext:t,getFeatures:n,getContext:a,evaluate:function(e){return new g(e)},on:w.on.bind(w),off:w.off.bind(w)}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),i=n(1),s=n.n(i);n.d(t,"events",function(){return b}),t.init=a;var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},f={key:"anonymous"},l="https://app.featureflow.io",p="https://rtm.featureflow.io",d={baseUrl:l,rtmUrl:p,streaming:!0,defaultFeatures:{}},h=new Error("init() has not been called with a valid apiKey"),b={LOADED:"LOADED",ERROR:"ERROR",UPDATED_FEATURE:"UPDATED_FEATURE"};t.default={init:a,events:b},void 0!==window.VERSION&&(e.exports.version=window.VERSION)}).call(t,n(2)(e))}])});